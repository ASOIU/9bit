---
layout: post
wp_id:  2758
title:  'Эволюция техники изоляции (sandbox) открытого документа (MS Word 2003-2013)'
author: chvetochek
date:             2013-05-11 04:11:51 +0000
last_modified_at: 2013-05-11 04:11:51 +0000
redirect_from: 
  - /excerpt/2758.html
  - /2013/2758/
  - /2013/2758/эволюция-техники-изоляции-sandbox-открытог/
authors: 
  - Пендер Екатерина
categories: 
  - Software
wp_wrong_noname_collection: 
  - Авторы
  - Рубрики
tags: 
  - moice
  - sandbox
  - word
  - безопасность
  - защищенный просмотр
  - макрос
---
<p><img style="float: right; padding: 0 10px;" src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/101px-Microsoft_Office_2013_symbol.svg.png %}" data-src-old="http://upload.wikimedia.org/wikipedia/commons/thumb/2/2d/Microsoft_Office_2013_symbol.svg/101px-Microsoft_Office_2013_symbol.svg.png" alt="Office" width="101" height="120" /></p>
<p style="text-align: justify;">Многие пользователи MS Word при выходе новой версии MS Office, скептически относятся к обновлению своих, уже ставших привычными, программ. Но стоит помнить, что в новых версиях устраняются многие "дыры" безопасности.</p>
<p style="text-align: justify;">Старые версии MS Word уже не отвечают современным требованиям безопасности, и могут быть легко взломаны:</p>
<ul>
<li><a href="http://resources.infosecinstitute.com/executing-office-2007-exploit-on-office-2010/" target="_blank">Executing Office 2007 Exploit on Office 2010</a></li>
<li><a href="http://rajhackingarticles.blogspot.ru/2012/08/hack-remote-windows-pc-attacking-on.html" target="_blank">Hack Remote Windows PC Attacking on Microsoft Word 2007 Document</a></li>
<li><a href="http://resources.infosecinstitute.com/loading-msgreen-dll-to-bypass-dep-office-2010-windows-7-double-click-rce-exploit/" target="_blank">Loading Msgreen.dll to Bypass DEP Office 2010 Windows 7 Double-Click RCE Exploit</a></li>
</ul>
<p><!--more--> Именно поэтому старайтесь обновлять свое ПО, если вы хотите быть уверены в защите своих документов (и банковских счетов) от несанкционированного получения доступа к ним третьими лицами.</p>
<p>&nbsp;</p>
<p style="text-align: center;">При подготовке материалов использована информация с сайтов: <a href="http://office.microsoft.com/ru-ru/word-help">office.microsoft.com</a>, <a href="http://blogs.technet.com/b/office_ru/archive/2009/11/12/test11-office-2010.aspx">blogs.technet.com</a> и <a href="http://desksite.ru/category/uluchshenie-zashhity-dokumenta-s-pomoshhyu-upravleniya-pravami-na-dostup-k-dannym/" target="_blank">desksite.ru</a></p>
<h1>2003</h1>
<p><img style="float: left; padding: 0 10px;" src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/word_holes[5].jpg %}" data-src-old="http://lh4.ggpht.com/_7xcSWdzoSj4/TR0gnFDK3xI/AAAAAAAAHPE/koniWWMpg5s/word_holes[5].jpg?imgmax=800" alt="" width="105" height="105" /></p>
<p style="text-align: justify;">Макрос — это набор команд и инструкций, группируемых вместе в виде единой команды для автоматического выполнения задачи. При открытии документа Word определяет, содержатся ли в нем макросы. Если макросов нет, документ открывается без дополнительных условий. При наличии макросов Word руководствуется текущими параметрами защиты. Можно установить один из трех уровней безопасности:</p>
<ul>
<li><strong>Высокий (High)</strong> — этот уровень позволяет запустить только макросы, подписанные и засвидетельствованные центрами сертификации, находящимися в списке «надежных источников» (неподписанные макросы автоматически отключаются);</li>
<li><strong>Средний (Medium)</strong> — в этом случае при открытии каждого файла будет выдаваться диалоговое окно с вопросом о целесообразности запуска макросов (это происходит каждый раз, когда открываемый файл содержит макрос, подписанный центром сертификации, не входящим в список);</li>
<li><strong>Низкий (Low)</strong> — этот уровень защиты разрешает запуск всех макросов, независимо от их свойств.</li>
</ul>
<p>По умолчанию в Word используется самый высокий уровень защиты.</p>
<h2>Контроль над распространением информации</h2>
<p style="text-align: justify;">В версии Word 2003 есть серьезные проблемы с безопасностью. Чтобы защитить информацию, содержащуюся в документах, пользователям предлагается ставить пароли. Самым надежным способом является установление пароля на открытие. В качестве алгоритма шифрования по умолчанию стоит алгоритм хеширования SHA1, ключ RC4 может иметь длину до 128 разрядов, а длина пароля может быть равна 255 символам.</p>
<p style="text-align: justify;">Если используется средство Версии, в файле с документом в качестве скрытой информации присутствуют различные его версии. Это очень удобно с точки зрения работы над документом, поскольку всегда можно вернуться к более ранним вариантам, но если послать кому-нибудь такой документ, адресат сможет ознакомиться со всеми версиями точно так же, как и их создатель. К тому же версии, как и любые скрытые данные, перестанут быть скрытыми при сохранении документа в другом формате. Чтобы избежать ненужного распространения информации, нужно удалить версии из документа прежде, чем отсылать его (применимо ко всем версиям пакета Office).</p>
<h1>2007</h1>
<p style="text-align: left;"><img style="float: right; padding: 0 10px;" src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/file-docx.png %}" data-src-old="http://www.torosltd.ru/upload/file-docx.png" alt="" width="128" height="128" /> В Microsoft Office 2007 значительно улучшена система защиты документов. Существенно изменен формат файлов: теперь вместо OLE-контейнеров применяется легко читаемый формат XML. Однако если файл защищен паролем «на открытие», документ представляет собой OLE-контейнер, в котором находится информация о шифровании и сам зашифрованный документ. Для шифрования применяется широко известный и криптостойкий алгоритм AES. Длина ключа всегда 128 бит, что исключает возможность прямого перебора ключей.</p>
<p style="text-align: justify;">Перед <a href="http://office.microsoft.com/ru-ru/excel-help/HA010031071.aspx">включением макроса</a> в документе, центр управления безопасностью выполняет следующие проверки:</p>
<ul>
<li>макрос должен быть удостоверен цифровой подписью разработчика;</li>
<li>цифровая подпись должна быть действительной;</li>
<li>цифровая подпись должна быть действующей (не просроченной);</li>
<li>сертификат цифровой подписи должен быть выдан общепризнанным центром сертификации;</li>
<li>разработчик, удостоверивший макрос, должен быть надежным.</li>
</ul>
<p style="text-align: justify;">Если центр управления безопасностью обнаруживает нарушение хотя бы одного из приведенных выше требований, макрос по умолчанию отключается и появляется панель сообщений с предупреждением о потенциальной опасности макроса.</p>
<h2>MOICE</h2>
<p style="text-align: justify;">Для решения проблемы атак группа разработки Office специально создала среду <a href="http://blogs.technet.com/b/office_ru/archive/2009/11/12/test11-office-2010.aspx">MOICE</a> (изолированная среда преобразования Microsoft Office, которая поддерживается только при использовании с пакетами Microsoft Office 2003 и Office 2007). Среда MOICE выполняла "обезвреживание" файла с помощью преобразования потенциально опасного двоичного файла в безопасный XML-формат, а затем обратно в двоичный и только после этого открывала файл. Кроме того, MOICE преобразует входящие файлы в изолированной среде, что помогает защитить компьютер от потенциальных угроз. Целью такого преобразования являлось удаление вредоносного кода, скрытого внутри файла.</p>
<p style="text-align: justify;">Среди недостатков среды MOICE можно отметить следующее: файлы, преобразование которых занимало много времени, долго открывались, что разочаровывало пользователей. Кроме того, после преобразования некоторые файлы могли отображаться не полностью, поэтому очевидно, что с точки зрения удобства использования, данная функция нуждалась в доработке.</p>
<h1>2010</h1>
<p><a href="http://technet.microsoft.com/ru-ru/library/cc179050(v=office.14).aspx" target="_blank">Многоуровневый подход к обеспечению безопасности (подробное описание доступно по этой ссылке)</a>: <img src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/IC387008.gif %}" data-src-old="http://i.technet.microsoft.com/dynimg/IC387008.gif" alt="Четыре уровня защиты" width="449" height="182" align="center/" /></p>
<p style="text-align: justify;">Четыре новых элемента управления позволяют повысить безопасность и уменьшить вероятность атаки. Ниже приведены эти элементы управления:</p>
<ul>
<li><strong>Поддержка предотвращения выполнения данных (DEP) для приложений Office</strong>. Аппаратная и программная технология, усиливающая защиту путем предотвращения выполнения вредоносного кода. Предотвращение выполнения данных позволяет предотвратить атаки, связанные с переполнением буфера, посредством идентификации файлов, которые пытаются выполнить код из той части памяти, которая зарезервирована только для данных.</li>
<li><strong>Проверка файлов Office</strong>. Компонент ПО, который способствует снижению вероятности атаки посредством поиска файлов, не соответствующих определению допустимого формата файлов.</li>
<li><strong>Расширенные параметры блокировки файлов</strong>. Параметры, управляемые в центре управления безопасностью и в групповой политике, которые способствуют снижению вероятности атаки путем предоставления более точного управления типами файлов, доступными для приложения.</li>
<li><strong>Защищенный просмотр.</strong></li>
</ul>
<p>Курс: "<a href="http://office.microsoft.com/ru-ru/word-help/RZ101665538.aspx?section=1" target="_blank">Безопасность Office 2010: защита файлов</a>"</p>
<h2>Защищенный просмотр</h2>
<p style="text-align: justify;">Ненадежные файлы открываются для просмотра в изолированной среде, известной как <a href="http://blogs.technet.com/b/office_ru/archive/2009/11/12/test11-office-2010.aspx" target="_blank">защищенный просмотр</a>. В этой среде пользователи могут просматривать файлы и копировать содержимое в буфер обмена. Однако они не могут печатать или редактировать файлы. Если документ содержит активное содержимое, такое как элементы управления ActiveX и макросы, отображается панель сообщений, запрашивающая разрешение на открытие активного содержимого.</p>
<p style="text-align: justify;">Песочница Office 2010 является "новой версией" изолированной среды MOICE, описанной ранее. Но в отличие от MOICE преобразование файла не выполняется. Вместо этого файл открывается в песочнице соответствующего приложения (Word, Excel или PowerPoint) и при наличии в файле вредоносного кода данный подход не позволит ему изменить документ, профиль или параметры пользователя.</p>
<p style="text-align: justify;">Кроме того, многие новые и улучшенные элементы обеспечения безопасности можно настраивать с помощью параметров групповой политики. Это облегчает применение и поддержку архитектуры безопасности в организации.</p>
<p style="text-align: center;"><a href="http://i.technet.microsoft.com/dynimg/IC387009.gif"><img src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/IC387009.gif %}" data-src-old="http://i.technet.microsoft.com/dynimg/IC387009.gif" alt="Блок-схема решений о доверии" width="305" height="437" /></a></p>
<h1>2013</h1>
<p style="text-align: justify;"><img style="float: right; padding: 0 10px;" src="{{ site.url }}{{ site.baseurl }}{% link /wp-content/uploads/2013/05/s147138_M.jpg %}" data-src-old="http://www.micromail.com/product_images/micromail.com/s147138_M.jpg" alt="" width="168" height="168" /> Теперь пользователь может создать свой профиль (Microsoft Live Account), а затем работать и получать доступ как к локальным файлам, так и к «облачным» документам без повторной идентификации себя.</p>
<p style="text-align: justify;">Защищенный просмотр помогает сократить число уязвимостей компьютера за счет открытия файлов в ограниченной среде, которую также называют песочницей, где их можно изучить перед открытием для редактирования в Excel, PowerPoint или Word. В предварительной версии Office 2013 используется более строгая изоляция процессов, при этом блокируется сетевой доступ из песочницы, пока пользователь не сочтет файл безопасным. <a href="http://technet.microsoft.com/en-us/library/cc179050(office.15).aspx" target="_blank">Подробнее</a>.</p>
<p style="text-align: justify;">Новый метод шифрования файлов Office 2013 позволяет администраторам расшифровывать защищенные паролем файлы с помощью дополнительного закрытого ключа. Теперь открытый ключ и сертификат сохраняются в заголовке файла после применения пароля. Если пароль будет утерян или забыт, администратор может использовать средство командной строки (с разрешением и правами доступа к сертификату и паролю, конечно) для удаления пароля или применения нового пароля.</p>
<p>Следует помнить, что сохраняя документ в режиме совместимости со старыми версиями, будут применены режимы защиты, которые характерны для предыдущих версий пакета.</p>

